!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.sapa=e():t.sapa=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"debounce",function(){return c}),n.d(r,"throttle",function(){return a}),n.d(r,"keyEach",function(){return l}),n.d(r,"keyMap",function(){return s}),n.d(r,"isUndefined",function(){return f}),n.d(r,"isNotUndefined",function(){return h}),n.d(r,"isArray",function(){return d}),n.d(r,"isBoolean",function(){return v}),n.d(r,"isString",function(){return y}),n.d(r,"isNotString",function(){return p}),n.d(r,"isObject",function(){return g}),n.d(r,"isFunction",function(){return m}),n.d(r,"isNumber",function(){return b}),n.d(r,"clone",function(){return k}),n.d(r,"html",function(){return w}),n.d(r,"uuid",function(){return C}),n.d(r,"uuidShort",function(){return T});var o={};n.r(o),n.d(o,"EventChecker",function(){return N}),n.d(o,"EventAfterRunner",function(){return _}),n.d(o,"EventBeforeRunner",function(){return L}),n.d(o,"CHECK_LOAD_PATTERN",function(){return D}),n.d(o,"CHECK_BIND_PATTERN",function(){return $}),n.d(o,"CHECK_PATTERN",function(){return I}),n.d(o,"NAME_SAPARATOR",function(){return B}),n.d(o,"CHECK_SAPARATOR",function(){return F}),n.d(o,"LOAD_SAPARATOR",function(){return H}),n.d(o,"BIND_SAPARATOR",function(){return K}),n.d(o,"SAPARATOR",function(){return z}),n.d(o,"CUSTOM",function(){return G}),n.d(o,"CLICK",function(){return q}),n.d(o,"DOUBLECLICK",function(){return X}),n.d(o,"MOUSEDOWN",function(){return Y}),n.d(o,"MOUSEUP",function(){return J}),n.d(o,"MOUSEMOVE",function(){return Z}),n.d(o,"MOUSEOVER",function(){return Q}),n.d(o,"MOUSEOUT",function(){return tt}),n.d(o,"MOUSEENTER",function(){return et}),n.d(o,"MOUSELEAVE",function(){return nt}),n.d(o,"TOUCHSTART",function(){return rt}),n.d(o,"TOUCHMOVE",function(){return ot}),n.d(o,"TOUCHEND",function(){return it}),n.d(o,"KEYDOWN",function(){return ut}),n.d(o,"KEYUP",function(){return ct}),n.d(o,"KEYPRESS",function(){return at}),n.d(o,"DRAG",function(){return lt}),n.d(o,"DRAGSTART",function(){return st}),n.d(o,"DROP",function(){return ft}),n.d(o,"DRAGOVER",function(){return ht}),n.d(o,"DRAGENTER",function(){return dt}),n.d(o,"DRAGLEAVE",function(){return vt}),n.d(o,"DRAGEXIT",function(){return yt}),n.d(o,"DRAGOUT",function(){return pt}),n.d(o,"DRAGEND",function(){return gt}),n.d(o,"CONTEXTMENU",function(){return mt}),n.d(o,"CHANGE",function(){return bt}),n.d(o,"INPUT",function(){return kt}),n.d(o,"FOCUS",function(){return Et}),n.d(o,"FOCUSIN",function(){return Ot}),n.d(o,"FOCUSOUT",function(){return wt}),n.d(o,"BLUR",function(){return St}),n.d(o,"PASTE",function(){return Ct}),n.d(o,"RESIZE",function(){return Tt}),n.d(o,"SCROLL",function(){return At}),n.d(o,"SUBMIT",function(){return Mt}),n.d(o,"POINTERSTART",function(){return xt}),n.d(o,"POINTERMOVE",function(){return Pt}),n.d(o,"POINTEREND",function(){return Rt}),n.d(o,"CHANGEINPUT",function(){return jt}),n.d(o,"WHEEL",function(){return Nt}),n.d(o,"CHECKER",function(){return _t}),n.d(o,"AFTER",function(){return Lt}),n.d(o,"BEFORE",function(){return Dt}),n.d(o,"IF",function(){return $t}),n.d(o,"ARROW_UP",function(){return Ut}),n.d(o,"ARROW_DOWN",function(){return It}),n.d(o,"ARROW_LEFT",function(){return Bt}),n.d(o,"ARROW_RIGHT",function(){return Ft}),n.d(o,"ENTER",function(){return Ht}),n.d(o,"SPACE",function(){return Kt}),n.d(o,"ALT",function(){return zt}),n.d(o,"SHIFT",function(){return Wt}),n.d(o,"META",function(){return Vt}),n.d(o,"CONTROL",function(){return Gt}),n.d(o,"SELF",function(){return qt}),n.d(o,"DEBOUNCE",function(){return Xt}),n.d(o,"THROTTLE",function(){return Yt}),n.d(o,"CAPTURE",function(){return Jt}),n.d(o,"MOVE",function(){return Zt}),n.d(o,"END",function(){return Qt}),n.d(o,"PREVENT",function(){return te}),n.d(o,"STOP",function(){return ee}),n.d(o,"createRef",function(){return ne}),n.d(o,"getRef",function(){return re}),n.d(o,"BIND_CHECK_FUNCTION",function(){return oe}),n.d(o,"BIND_CHECK_DEFAULT_FUNCTION",function(){return ie}),n.d(o,"LOAD",function(){return ue}),n.d(o,"BIND",function(){return ce}),n.d(o,"Event",function(){return ae});var i={};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){var n=void 0;return function(r,o,i,u,c){n&&clearTimeout(n),n=setTimeout(function(){t(r,o,i,u,c)},e||300)}}function a(t,e){var n=void 0;return function(r,o,i,u,c){n||(n=setTimeout(function(){t(r,o,i,u,c),n=null},e||300))}}function l(t,e){Object.keys(t).forEach(function(n,r){e(n,t[n],r)})}function s(t,e){return Object.keys(t).map(function(n,r){return e(n,t[n],r)})}function f(t){return null==t}function h(t){return!1===f(t)}function d(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return"string"==typeof t}function p(t){return!1===y(t)}function g(t){return"object"==u(t)&&!d(t)&&!b(t)&&!y(t)&&null!==t}function m(t){return"function"==typeof t}function b(t){return"number"==typeof t}function k(t){return JSON.parse(JSON.stringify(t))}n.r(i),n.d(i,"start",function(){return qe});var E=/\<(\w*)([^\>]*)\/\>/gim,O={image:!0,input:!0,br:!0,path:!0},w=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=t.map(function(t,e){var r=n[e]||"";return m(r)&&(r=r()),d(r)||(r=[r]),t+(r=r.map(function(t){return g(t)&&!d(t)?Object.keys(t).map(function(e){return"".concat(e,'="').concat(t[e],'"')}).join(" "):t}).join(""))}).join("");return o=o.replace(E,function(t,e){return O[e.toLowerCase()]?t:t.replace("/>","></".concat(e,">"))})},S=/[xy]/g;function C(){var t=(new Date).getTime();return"xxx12-xx-34xx".replace(S,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}function T(){var t=(new Date).getTime();return"idxxxxxxx".replace(S,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}function A(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e,n,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p(e))this.el=e;else{var o=document.createElement(e);for(var i in n&&(o.className=n),r=r||{})o.setAttribute(i,r[i]);this.el=o}}var e,n,r;return e=t,n=[{key:"attr",value:function(t,e){return 1==arguments.length?this.el.getAttribute(t):(this.el.setAttribute(t,e),this)}},{key:"attrs",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(function(e){return t.el.getAttribute(e)})}},{key:"styles",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(function(e){return t.el.style[e]})}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"removeStyle",value:function(t){return this.el.style.removeProperty(t),this}},{key:"is",value:function(t){return this.el===(t.el||t)}},{key:"closest",value:function(e){for(var n=this,r=!1;!(r=n.hasClass(e));){if(!n.el.parentNode)return null;n=t.create(n.el.parentNode)}return r?n:null}},{key:"parent",value:function(){return t.create(this.el.parentNode)}},{key:"hasParent",value:function(){return!!this.el.parentNode}},{key:"removeClass",value:function(){var t;return(t=this.el.classList).remove.apply(t,arguments),this}},{key:"hasClass",value:function(t){return!!this.el.classList&&this.el.classList.contains(t)}},{key:"addClass",value:function(){var t;return(t=this.el.classList).add.apply(t,arguments),this}},{key:"onlyOneClass",value:function(t){var e=this.parent().$(".".concat(t));e&&e.removeClass(t),this.addClass(t)}},{key:"toggleClass",value:function(t,e){this.el.classList.toggle(t,e)}},{key:"html",value:function(t){return f(t)?this.el.innerHTML:(y(t)?this.el.innerHTML=t:this.empty().append(t),this)}},{key:"find",value:function(t){return this.el.querySelector(t)}},{key:"$",value:function(e){var n=this.find(e);return n?t.create(n):null}},{key:"findAll",value:function(t){return this.el.querySelectorAll(t)}},{key:"$$",value:function(e){return A(this.findAll(e)).map(function(e){return t.create(e)})}},{key:"empty",value:function(){return this.html("")}},{key:"append",value:function(t){return y(t)?this.el.appendChild(document.createTextNode(t)):this.el.appendChild(t.el||t),this}},{key:"appendHTML",value:function(e){var n=t.create("div").html(e);this.append(n.createChildrenFragment())}},{key:"createChildrenFragment",value:function(){var t=this.children(),e=document.createDocumentFragment();return t.forEach(function(t){return e.appendChild(t.el)}),e}},{key:"appendTo",value:function(t){return(t.el?t.el:t).appendChild(this.el),this}},{key:"remove",value:function(){return this.el.parentNode&&this.el.parentNode.removeChild(this.el),this}},{key:"text",value:function(e){if(f(e))return this.el.textContent;var n=e;return e instanceof t&&(n=e.text()),this.el.textContent=n,this}},{key:"css",value:function(t,e){if(h(t)&&h(e))this.el.style[t]=e;else if(h(t)){if(y(t))return getComputedStyle(this.el)[t];for(var n=Object.keys(t||{}),r=0,o=n.length;r<o;r++){var i=n[r];this.el.style[i]=t[i]}}return this}},{key:"getComputedStyle",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){for(var t=getComputedStyle(this.el),e={},n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.forEach(function(n){e[n]=t[n]}),e})},{key:"getStyleList",value:function(){for(var t=this,e={},n=this.el.style.length,r=0;r<n;r++){var o=this.el.style[r];e[o]=this.el.style[o]}for(var i=arguments.length,u=new Array(i),c=0;c<i;c++)u[c]=arguments[c];return u.forEach(function(n){e[n]=t.css(n)}),e}},{key:"cssText",value:function(t){return f(t)?this.el.style.cssText:(t!=this.el.style.cssText&&(this.el.style.cssText=t),this)}},{key:"cssArray",value:function(t){return t[0]&&(this.el.style[t[0]]=t[1]),t[2]&&(this.el.style[t[2]]=t[3]),t[4]&&(this.el.style[t[4]]=t[5]),t[6]&&(this.el.style[t[6]]=t[7]),t[8]&&(this.el.style[t[8]]=t[9]),this}},{key:"cssFloat",value:function(t){return parseFloat(this.css(t))}},{key:"cssInt",value:function(t){return parseInt(this.css(t))}},{key:"px",value:function(t,e){return this.css(t,e+"px")}},{key:"rect",value:function(){return this.el.getBoundingClientRect()}},{key:"offsetRect",value:function(){return{top:this.el.offsetTop,left:this.el.offsetLeft,width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"offset",value:function(){var e=this.rect(),n=t.getScrollTop(),r=t.getScrollLeft();return{top:e.top+n,left:e.left+r}}},{key:"offsetLeft",value:function(){return this.offset().left}},{key:"offsetTop",value:function(){return this.offset().top}},{key:"position",value:function(){return this.el.style.top?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}},{key:"size",value:function(){return[this.width(),this.height()]}},{key:"width",value:function(){return this.el.offsetWidth||this.rect().width}},{key:"contentWidth",value:function(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}},{key:"height",value:function(){return this.el.offsetHeight||this.rect().height}},{key:"contentHeight",value:function(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}},{key:"val",value:function(e){var n=e;return e instanceof t&&(n=e.val()),this.el.value=n,this}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"block";return this.css("display","none"!=t?t:"block")}},{key:"hide",value:function(){return this.css("display","none")}},{key:"toggle",value:function(t){var e="none"==this.css("display");return 1==arguments.length?e&&t?this.show():this.hide():e?this.show():this.hide()}},{key:"scrollIntoView",value:function(){this.el.scrollIntoView()}},{key:"setScrollTop",value:function(t){return this.el.scrollTop=t,this}},{key:"setScrollLeft",value:function(t){return this.el.scrollLeft=t,this}},{key:"on",value:function(t,e,n,r){return this.el.addEventListener(t,e,n,r),this}},{key:"off",value:function(t,e){return this.el.removeEventListener(t,e),this}},{key:"getElement",value:function(){return this.el}},{key:"createChild",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t.create(e,n,r);return i.css(o),this.append(i),i}},{key:"firstChild",value:function(){return t.create(this.el.firstElementChild)}},{key:"children",value:function(){var e=this.el.firstElementChild;if(!e)return[];var n=[];do{n.push(t.create(e)),e=e.nextElementSibling}while(e);return n}},{key:"childLength",value:function(){return this.el.children.length}},{key:"replace",value:function(t){return this.el.parentNode.replaceChild(t.el||t,this.el),this}},{key:"checked",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0==arguments.length?!!this.el.checked:(this.el.checked=!!t,this)}},{key:"focus",value:function(){return this.el.focus(),this}},{key:"select",value:function(){return this.el.select(),this}},{key:"blur",value:function(){return this.el.blur(),this}},{key:"select",value:function(){return this.el.select(),this}},{key:"value",get:function(){return this.el.value}},{key:"scrollTop",get:function(){return this.el===document.body?t.getScrollTop():this.el.scrollTop}},{key:"scrollLeft",get:function(){return this.el===document.body?t.getScrollLeft():this.el.scrollLeft}},{key:"scrollHeight",get:function(){return this.el.scrollHeight}},{key:"scrollWidth",get:function(){return this.el.scrollWidth}}],r=[{key:"create",value:function(e,n,r){return new t(e,n,r)}},{key:"getScrollTop",value:function(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}},{key:"getScrollLeft",value:function(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}},{key:"parse",value:function(t){return DOMParser().parseFromString(t,"text/htmll")}}],n&&M(e.prototype,n),r&&M(e,r),t}();function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,n){return e&&R(t.prototype,e),n&&R(t,n),t}var N=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;P(this,t),this.value=e,this.split=n}return j(t,[{key:"toString",value:function(){return" ".concat(this.split," ")+this.value}}]),t}(),_=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;P(this,t),this.value=e,this.split=n}return j(t,[{key:"toString",value:function(){return" ".concat(this.split," after(").concat(this.value,")")}}]),t}(),L=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;P(this,t),this.value=e,this.split=n}return j(t,[{key:"toString",value:function(){return" ".concat(this.split," before(").concat(this.value,")")}}]),t}(),D=/^load (.*)/gi,$=/^bind (.*)/gi,U=["click|dblclick","mouse(down|up|move|over|out|enter|leave)","pointer(start|move|end)","touch(start|move|end)","key(down|up|press)","drag|drop|drag(start|over|enter|leave|exit|end)","contextmenu","change|input|focus|blur|focus(in|out)","paste","resize|scroll|wheel|mousewheel|DOMMouseScroll","submit"].join("|"),I=new RegExp("^(".concat(U,"s)"),"ig"),B=":",F="|",H="load ",K="bind ",z=" ",W={},V=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.join(B);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return[r].concat(e).join(z)}},G=V,q=V("click"),X=V("dblclick"),Y=V("mousedown"),J=V("mouseup"),Z=V("mousemove"),Q=V("mouseover"),tt=V("mouseout"),et=V("mouseenter"),nt=V("mouseleave"),rt=V("touchstart"),ot=V("touchmove"),it=V("touchend"),ut=V("keydown"),ct=V("keyup"),at=V("keypress"),lt=V("drag"),st=V("dragstart"),ft=V("drop"),ht=V("dragover"),dt=V("dragenter"),vt=V("dragleave"),yt=V("dragexit"),pt=V("dragout"),gt=V("dragend"),mt=V("contextmenu"),bt=V("change"),kt=V("input"),Et=V("focus"),Ot=V("focusin"),wt=V("focusout"),St=V("blur"),Ct=V("paste"),Tt=V("resize"),At=V("scroll"),Mt=V("submit"),xt=G("mousedown","touchstart"),Pt=G("mousemove","touchmove"),Rt=G("mouseup","touchend"),jt=G("change","input"),Nt=G("wheel","mousewheel","DOMMouseScroll"),_t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;return new N(t,e)},Lt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;return new _(t,e)},Dt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F;return new L(t,e)},$t=_t,Ut=_t("ArrowUp"),It=_t("ArrowDown"),Bt=_t("ArrowLeft"),Ft=_t("ArrowRight"),Ht=_t("Enter"),Kt=_t("Space"),zt=_t("isAltKey"),Wt=_t("isShiftKey"),Vt=_t("isMetaKey"),Gt=_t("isCtrlKey"),qt=_t("self"),Xt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return _t("debounce(".concat(t,")"))},Yt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return _t("throttle(".concat(t,")"))},Jt=_t("capture()"),Zt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"move";return Lt("bodyMouseMove ".concat(t))},Qt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"end";return Lt("bodyMouseUp ".concat(t))},te=Lt("preventDefault"),ee=Lt("stopPropagation"),ne=function(t){if(""===t)return"";var e=C();return W[e]=t,e},re=function(t){return W[t]||""},oe=function(t){return function(){return this.prevState[t]!=this.state[t]}},ie=function(){return!0},ue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el";return H+t},ce=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"$el",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return K+t+(e?F+ne(e):"")},ae={addEvent:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t&&t.addEventListener(e,n,r)},removeEvent:function(t,e,n){t&&t.removeEventListener(e,n)},pos:function(t){return t.touches&&t.touches[0]?t.touches[0]:t},posXY:function(t){var e=this.pos(t);return{x:e.pageX,y:e.pageY}}};function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var se=function(){function t(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.callbacks={}}var e,n,r;return e=t,(n=[{key:"getCallbacks",value:function(t){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t]}},{key:"setCallbacks",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.callbacks[t]=e}},{key:"on",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=r>0?c(e,r):e;this.getCallbacks(t).push({event:t,callback:o,context:n,originalCallback:e})}},{key:"off",value:function(t,e){1==arguments.length?this.setCallbacks(t):2==arguments.length&&this.setCallbacks(t,this.getCallbacks(t).filter(function(t){return t.originalCallback!==e}))}},{key:"offAll",value:function(t){var e=this;Object.keys(this.callbacks).forEach(function(n){e.setCallbacks(n,e.getCallbacks(n).filter(function(e){return e.context!==t}))})}},{key:"getCachedCallbacks",value:function(t){return this.getCallbacks(t)}},{key:"sendMessage",value:function(t,e,n,r,o,i){var u=this;setTimeout(function(){var c=u.getCachedCallbacks(e);c&&c.filter(function(e){return e.originalCallback.source!==t}).forEach(function(t){return t.callback(n,r,o,i)})},0)}},{key:"triggerMessage",value:function(t,e,n,r,o,i){var u=this;setTimeout(function(){var c=u.getCachedCallbacks(e);c?c.filter(function(e){return e.originalCallback.source===t}).forEach(function(t){return t.callback(n,r,o,i)}):console.warn(e," is not valid event")},0)}},{key:"emit",value:function(t,e,n,r,o){this.sendMessage(this.source,t,e,n,r,o)}},{key:"trigger",value:function(t,e,n,r,o){this.triggerMessage(this.source,t,e,n,r,o)}}])&&le(e.prototype,n),r&&le(e,r),t}();function fe(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n        ","\n      "]);return fe=function(){return t},t}function he(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ve(t){return be(t)||pe(t)||me()}function ye(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||pe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function pe(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function ge(t,e){return be(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||me()}function me(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function be(t){if(Array.isArray(t))return t}var ke=x.create("div"),Ee="[".concat("ref","]"),Oe=["ref"],we=function(t,e,n){return function(r){var o=Ce(t,r,e,n);if(h(o))return o}},Se=function(t,e,n){return function(r){var o=function(t,e){return function t(e,n){return e?e.matches(n)?e:t(e.parentElement,n):null}(t.target||t.srcElement,e.delegate)}(r,e);if(o){r.$delegateTarget=x.create(o);var i=Ce(t,r,e,n);if(h(i))return i}}},Ce=function(t,e,n,r){if(e.xy=ae.posXY(e),n.beforeMethods.length&&n.beforeMethods.every(function(n){return t[n.target].call(t,e,n.param)}),Te(t,e,n)){var o=r(e,e.$delegateTarget,e.xy);return n.afterMethods.length&&n.afterMethods.forEach(function(n){return t[n.target].call(t,e,n.param)}),o}},Te=function(t,e,n){var r=!0;n.codes.length&&(r=!!e.code&&n.codes.includes(e.code.toLowerCase())||!!e.key&&n.codes.includes(e.key.toLowerCase()));var o=!0;return n.checkMethodList.length&&(o=n.checkMethodList.every(function(n){var r=t[n];return m(r)&&r?r.call(t,e):!h(r)||!!r})),r&&o},Ae=function(t,e){var n=t.filter(function(t){return t.indexOf("".concat(e,"("))>-1}),r=n.map(function(t){var n=ge(t.split("".concat(e,"("))[1].split(")")[0].trim().split(" "),2);return{target:n[0],param:n[1]}});return[n,r]},Me=function(t,e,n){e.callback=function(t,e,n){return e.delegate?Se(t,e,n):we(t,e,n)}(t,e,n),t.addBinding(e),ae.addEvent(e.dom,e.eventName,e.callback,!!e.captures.length)},xe=function(t,e,n,r){var o=ve(e),i=o[0],u=o[1],l=o.slice(2),s=function(t,e,n){var r=n,o=r.filter(function(e){return!!t[e]}),i=ge(Ae(r,"after"),2),u=i[0],c=i[1],a=ge(Ae(r,"before"),2),l=a[0],s=a[1],f=ge(Ae(r,"debounce"),2),h=f[0],d=f[1],v=ge(Ae(r,"throttle"),2),y=v[0],p=v[1],g=ge(Ae(r,"capture"),1)[0],m=[].concat(ye(o),ye(u),ye(l),ye(h),ye(y),ye(g));return{eventName:e,codes:r.filter(function(t){return!m.includes(t)}).map(function(t){return t.toLowerCase()}),captures:g,afterMethods:c,beforeMethods:s,debounceMethods:d,throttleMethods:p,checkMethodList:o}}(t,i,n);if(s.dom=function(t,e){var n;return(n=e?t.refs[e]||t[e]||window[e]:t.el||t.$el||t.$root)instanceof x?n.getElement():n}(t,u),s.delegate=l.join(z),s.debounceMethods.length)r=c(r,+s.debounceMethods[0].target);else if(s.throttleMethods.length){r=a(r,+s.throttleMethods[0].target)}Me(t,s,r)},Pe=function(t,e){var n=e.split(F).map(function(t){return t.trim()}),r=ve(n.shift().split(z)),o=r[0],i=r.slice(1),u=function(t){var e=[];return t.split(B).forEach(function(t){return e.push.apply(e,ye(t.split(B)))}),e}(o),c=t[e].bind(t);u.forEach(function(e){xe(t,[e].concat(ye(i)),n,c)})},Re=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state={},this.prevState={},this.refs={},this.children={},this._bindings=[],this.id=C(),this.childComponents=this.components()}var e,n,r;return e=t,(n=[{key:"initState",value:function(){return{}}},{key:"setState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.prevState=this.state,this.state=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){he(t,e,n[e])})}return t}({},this.state,t),e&&this.load()}},{key:"_reload",value:function(t){this.props=t,this.setState(this.initState(),!1),this.refresh()}},{key:"render",value:function(t){this.$el=this.parseTemplate(w(fe(),this.template())),this.refs.$el=this.$el,t&&t.append(this.$el),this.load(),this.parseComponent(!1),this.afterRender()}},{key:"initialize",value:function(){this.state=this.initState()}},{key:"afterRender",value:function(){}},{key:"components",value:function(){return{}}},{key:"getRef",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.refs[e.join("")]}},{key:"parseTemplate",value:function(t,e){var n=this;d(t)&&(t=t.join("")),t=t.trim();var r=ke.html(t).children();return r.forEach(function(t){var e=t.attr("ref");e&&(n.refs[e]=t);var r=t.$$(Ee),o={};r.forEach(function(t){var r=t.attr("ref");o[r]?console.warn("".concat(e," is duplicated. - ").concat(n.sourceName)):o[r]=!0,n.refs[r]=t})}),e?ke.createChildrenFragment():r[0]}},{key:"childrenIds",value:function(){return s(this.children,function(t,e){return e.id})}},{key:"parseProperty",value:function(t){var e={};return ye(t.el.attributes).filter(function(t){return Oe.indexOf(t.nodeName)<0}).forEach(function(t){e[t.nodeName]=t.nodeValue}),t.$$("property").forEach(function(t){var n=ge(t.attrs("name","value","type"),3),r=n[0],o=n[1],i=n[2],u=o||t.text();"json"===i&&(u=JSON.parse(u)),e[r]=u}),e}},{key:"parseComponent",value:function(){var t=this,e=this.$el;l(this.childComponents,function(n,r){e.$$(n.toLowerCase()).forEach(function(e){var n=t.parseProperty(e),o=e.attr("ref"),i=null;t.children[o]?(i=t.children[o])._reload(n):(i=new r(t,n),t.children[o||i.id]=i,i.render(),i.initializeEvent()),e.replace(i.$el)})}),l(this.children,function(e,n){n&&n.clean()&&delete t.children[e]})}},{key:"clean",value:function(){if(!this.$el.hasParent())return l(this.children,function(t,e){e.clean()}),this.destroy(),this.$el=null,!0}},{key:"refresh",value:function(){this.load()}},{key:"loadTemplate",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this[ue(e.join(""))].call(this)}},{key:"load",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._loadMethods||(this._loadMethods=this.filterProps(D)),this._loadMethods.filter(function(t){var e=t.split(H)[1];return!n.length||n.includes(e)}).forEach(function(e){var r=e.split(H)[1];if(t.refs[r]){var o,i=(o=t[e]).call.apply(o,[t].concat(n));d(i)&&(i=i.join(""));var u=t.parseTemplate(i,!0);t.refs[r].html(u),t.initializeDomEvent()}}),this.bindData(),this.parseComponent()}},{key:"bindData",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this._bindMethods||(this._bindMethods=this.filterProps($)),this._bindMethods.filter(function(t){if(!n.length)return!0;var e=ge(t.split(F),2),r=e[0],o=(e[1],ge(r.split(" "),2)),i=(o[0],o[1]);return n.includes(i)}).forEach(function(e){var r=t[e],o=ge(e.split(F),2),i=(e=o[0],o[1]),u=t.getRef(i),c=ie;""!=u&&y(u)?c=oe(u):m(u)&&(c=u);var a=e.split(K)[1],s=t.refs[a],h=m(c)&&c.call(t);if(s&&h){var v=r.call.apply(r,[t].concat(n));if(!v)return;l(v,function(t,e){!function(t,e,n){"style"!==e?"class"!==e?f(n)?t.removeAttr(e):"TEXTAREA"===t.el.nodeName&&"value"===e?t.text(n):"innerHTML"===e?t.html(n):t.attr(e,n):d(n)?t.addClass.apply(t,ye(n)):g(n)?l(n,function(e,r){n?t.addClass(e):t.removeClass(e)}):t.addClass(n):g(n)&&l(n,function(e,n){n?t.css(e,n):t.removeStyle(e)})}(s,t,e)})}})}},{key:"template",value:function(){var t=this.templateClass(),e=t?'class="'.concat(t,'"'):"";return"<div ".concat(e,"></div>")}},{key:"templateClass",value:function(){return null}},{key:"eachChildren",value:function(t){m(t)&&l(this.children,function(e,n){return t(n)})}},{key:"initializeEvent",value:function(){this.initializeDomEvent(),this.eachChildren(function(t){return t.initializeEvent()})}},{key:"destroy",value:function(){this.destroyDomEvent(),this.eachChildren(function(t){return t.destroy()})}},{key:"destroyDomEvent",value:function(){this.removeEventAll()}},{key:"initializeDomEvent",value:function(){var t=this;this.destroyDomEvent(),this.filterProps(I).forEach(function(e){return Pe(t,e)})}},{key:"collectProps",value:function(){var t=this,e=this.__proto__,n=[];do{if(!1===e instanceof Object)break;var r=Object.getOwnPropertyNames(e).filter(function(e){return m(t[e])});n.push.apply(n,ye(r)),e=e.__proto__}while(e);return n}},{key:"filterProps",value:function(t){return this.collectProps().filter(function(e){return e.match(t)})}},{key:"self",value:function(t){return t&&t.$delegateTarget&&t.$delegateTarget.is(t.target)}},{key:"isAltKey",value:function(t){return t.altKey}},{key:"isCtrlKey",value:function(t){return t.ctrlKey}},{key:"isShiftKey",value:function(t){return t.shiftKey}},{key:"isMetaKey",value:function(t){return t.metaKey}},{key:"preventDefault",value:function(t){return t.preventDefault(),!0}},{key:"stopPropagation",value:function(t){return t.stopPropagation(),!0}},{key:"bodyMouseMove",value:function(t,e){this[e]&&this.emit("add/body/mousemove",this[e],this,t.xy)}},{key:"bodyMouseUp",value:function(t,e){this[e]&&this.emit("add/body/mouseup",this[e],this,t.xy)}},{key:"getBindings",value:function(){return this._bindings||this.initBindings(),this._bindings}},{key:"addBinding",value:function(t){this.getBindings().push(t)}},{key:"initBindings",value:function(){this._bindings=[]}},{key:"removeEventAll",value:function(){var t=this;this.getBindings().forEach(function(e){t.removeEvent(e)}),this.initBindings()}},{key:"removeEvent",value:function(t){var e=t.eventName,n=t.dom,r=t.callback;ae.removeEvent(n,e,r)}}])&&de(e.prototype,n),r&&de(e,r),t}();function je(t){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,c=t[Symbol.iterator]();!(r=(u=c.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Le(t,e){return!e||"object"!==je(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(t,e,n){return(De="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$e(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ie=/^ME@/,Be=function(){return"ME@"+function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.join("|")}.apply(void 0,arguments)},Fe=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Le(this,$e(e).call(this,t))).initializeProperty(t,r),n.created(),n.initialize(),n.initializeStoreEvent(),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ue(t,e)}(e,Re),n=e,(r=[{key:"initializeProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.opt=t||{},this.parent=this.opt,this.props=e,this.source=C(),this.sourceName=this.constructor.name,t&&t.$store&&(this.$store=t.$store),t&&t.$app&&(this.$app=t.$app)}},{key:"created",value:function(){}},{key:"getRealEventName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ME@",n=t.indexOf(e);return t.substr(n<0?0:n+e.length)}},{key:"initializeStoreEvent",value:function(){var t=this;this.storeEvents={},this.filterProps(Ie).forEach(function(e){var n=t.getRealEventName(e,"ME@"),r=Ne(Ae(n.split("|"),"debounce"),2),o=r[0],i=r[1],u=0;o.length&&(u=+i[0].target||0),n.split("|").filter(function(t){return!1===o.includes(t)}).map(function(t){return t.trim()}).forEach(function(n){var r=t[e].bind(t);r.source=t.source,t.storeEvents[n]=r,t.$store.on(n,t.storeEvents[n],t,u)})})}},{key:"destoryStoreEvent",value:function(){this.$store.offAll(this),this.storeEvents={}}},{key:"destroy",value:function(){De($e(e.prototype),"destroy",this).call(this),this.destoryStoreEvent()}},{key:"emit",value:function(){var t;this.$store.source=this.source,(t=this.$store).emit.apply(t,arguments)}},{key:"trigger",value:function(){var t;this.$store.source=this.source,(t=this.$store).trigger.apply(t,arguments)}},{key:"on",value:function(t,e){this.$store.on(t,e)}},{key:"off",value:function(t,e){this.$store.off(t,e)}}])&&_e(n.prototype,r),o&&_e(n,o),e}();function He(t){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ze(t,e){return!e||"object"!==He(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function We(t){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ve(t,e){return(Ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ge={x:0,y:0},qe=function(t){return new(function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),ze(this,We(n).apply(this,arguments))}var r,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ve(t,e)}(n,Fe),r=n,(o=[{key:"initialize",value:function(){this.$store=new se,this.$app=this,this.$container=x.create(this.getContainer()),this.$container.addClass(this.getClassName()),this.render(this.$container),this.initializeEvent(),this.initBodyMoves()}},{key:"initState",value:function(){return{pos:{},oldPos:{}}}},{key:"initBodyMoves",value:function(){this.moves=new Set,this.ends=new Set,this.modifyBodyMoveSecond(10)}},{key:"modifyBodyMoveSecond",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.funcBodyMoves=c(this.loopBodyMoves.bind(this),t)}},{key:"loopBodyMoves",value:function(){var t=this.state,e=t.oldPos,n=t.pos;(e.x!=n.x||e.y!=n.y)&&this.moves.size&&this.moves.forEach(function(t){var e=n.x-t.xy.x,r=n.y-t.xy.y;0==e&&0==r||t.func.call(t.context,e,r,"move")}),requestAnimationFrame(this.funcBodyMoves)}},{key:"removeBodyMoves",value:function(){var t=this.state.pos;this.ends.forEach(function(e){e.func.call(e.context,t.x-e.xy.x,t.y-e.xy.y,"end")}),this.moves.clear(),this.ends.clear()}},{key:Be("add/body/mousemove"),value:function(t,e,n){this.moves.add({func:t,context:e,xy:n})}},{key:Be("add/body/mouseup"),value:function(t,e,n){this.ends.add({func:t,context:e,xy:n})}},{key:"getClassName",value:function(){return t.className||"sapa"}},{key:"getContainer",value:function(){return t.container||document.body}},{key:"template",value:function(){return"<div>".concat(t.template,"</div>")}},{key:"components",value:function(){return t.components||{}}},{key:Pt("document"),value:function(t){var e=this.state.pos||Ge,n=t.xy||Ge;this.bodyMoved=!(e.x==n.x&&e.y==n.y),this.setState({bodyEvent:t,pos:n,oldPos:e},!1),this.requestId||(this.requestId=requestAnimationFrame(this.funcBodyMoves))}},{key:Rt("document"),value:function(t){var e=t.xy||Ge;this.setState({bodyEvent:t,pos:e},!1),this.removeBodyMoves(),this.requestId=null}}])&&Ke(r.prototype,o),i&&Ke(r,i),n}())(t)};function Xe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ye=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){Xe(t,e,n[e])})}return t}({Dom:x,UIElement:Fe,App:i},o,r);e.default=Ye}]).default});